(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7864"],{"0BXH":function(e,t,s){"use strict";var a=s("gGBZ");s.n(a).a},N6NU:function(e,t,s){"use strict";s.r(t);var a=s("jWXv"),r=s.n(a),i=s("t3Un");function n(e){var t=new URLSearchParams;return t.append("parentId",e),Object(i.a)({url:"system/sysMenu/getChildrenMenuByParentId",method:"post",data:t})}var o={data:function(){var e=this,t=function(e,t,s){t&&t.length>150?s(new Error("url路径的长度不能超过150个字符")):s()};return{currentData:void 0,currentId:void 0,isRight:!0,checkoutId:void 0,checkoutParentId:void 0,parentId:void 0,oldResourcesName:void 0,resourcesForm:{id:void 0,resourcesName:void 0,resourcesUrl:void 0,menuId:void 0},resourcesDialogVisible:!1,tableData:[],isShowMenuDir:!1,dataForm:{menuName:void 0,menuUrl:void 0},oldMenuData:[],isMove:!0,isData:!1,isShowInfo:!1,isTrue:!1,subForm:{menuData:[{label:""}]},currentMenuName:void 0,location:"1",visible:!0,isShow:!1,oldMenuName:void 0,isDisabled:!1,radio:"1",menuId:void 0,menuForm:{id:void 0,parentId:void 0,menuName:void 0,menuUrl:"/"},dialogStatus:void 0,menuDialogVisible:!1,listLoading:!1,menuList:[],rules:{menuName:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{validator:function(t,s,a){/^[\u4e00-\u9fa5\w]{1,20}$/.test(s)?e.oldMenuName!==e.menuForm.menuName?function(e){return Object(i.a)({url:"system/sysMenu/checkMenuName",method:"post",data:e})}({menuName:s,parentId:e.menuForm.parentId}).then(function(e){"fail"===e.data.data?a(new Error("菜单名称已重复")):a()}):a():a(new Error("名称只允许数字、中文、字母及下划线"))},trigger:"blur"}],menuUrl:[{required:!0,message:"url不能为空",trigger:"blur"},{validator:t,trigger:"blur"}],resourcesUrl:[{required:!0,message:"url不能为空",trigger:"blur"},{validator:t,trigger:"blur"}],resourcesName:[{required:!0,message:"请输入功能名称",trigger:"blur"},{validator:function(t,s,a){/^[\u4e00-\u9fa5\w]{1,20}$/.test(s)?e.oldResourcesName!==e.resourcesForm.resourcesName?function(e){return Object(i.a)({url:"system/sysResources/checkResourceName",method:"post",data:e})}({resourceName:e.resourcesForm.resourcesName,menuId:e.resourcesForm.menuId}).then(function(e){"0000"===e.data.code&&("success"===e.data.data?a():a(new Error("功能名称已重复")))}):a():a(new Error("名称只允许数字、中文、字母及下划线"))},trigger:"blur"}]},menuDataRules:{label:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{validator:function(t,s,a){if(/^[\u4e00-\u9fa5\w]{1,20}$/.test(s)){var r=0;e.subForm.menuData.forEach(function(e,t){s===e.label&&(r+=1)}),r>1?a(new Error("菜单名称已重复")):a()}else a(new Error("名称只允许数字、中文、字母及下划线"))},trigger:"blur"}]}}},watch:{radio:function(){"1"===this.radio?this.isShow=!1:"2"===this.radio&&(this.isShow=!0)},location:function(){"1"===this.location?this.menuForm.parentId=this.checkoutParentId:"0"===this.location&&(this.menuForm.parentId=this.checkoutId)}},mounted:function(){this.initList()},methods:{checkoutSubName:function(){var e=[];this.subForm.menuData.forEach(function(t){e.push(t.label)}),new r.a(e).size===e.length&&this.$refs.subForm.clearValidate()},deleteResourcesName:function(e){var t=this;this.$confirm("此操作将永久删除这条数据, 是否继续?","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){(function(e){var t=new URLSearchParams;return t.append("ids",e),Object(i.a)({url:"system/sysResources/delete",method:"post",data:t})})(e).then(function(e){"0000"===e.data.code?(t.$message({message:"删除成功",type:"success"}),t.initList(),t.getResources()):t.$message.error(e.data.result)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},updateResources:function(){var e=this;this.$refs.resourcesForm.validate(function(t){t&&(e.isDisabled=!0,function(e){return Object(i.a)({url:"system/sysResources/update",method:"post",data:e})}(e.resourcesForm).then(function(t){"0000"===t.data.code?e.$message({message:"编辑成功",type:"success"}):e.$message.error(t.data.result),e.isDisabled=!1,e.resourcesDialogVisible=!1,e.$refs.resourcesForm.resetFields(),e.initList(),e.getResources()}))})},handleUpdate:function(e){this.oldResourcesName=e.resourcesName,this.resourcesDialogVisible=!0,this.dialogStatus="编辑功能",this.resourcesForm.id=e.id,this.resourcesForm.resourcesName=e.resourcesName,this.resourcesForm.menuId=e.menuId,this.resourcesForm.resourcesUrl=e.resourcesUrl,this.$refs.resourcesForm.clearValidate()},createResources:function(){var e=this;this.$refs.resourcesForm.validate(function(t){t&&(e.isDisabled=!0,function(e){return Object(i.a)({url:"system/sysResources/add",method:"post",data:e})}(e.resourcesForm).then(function(t){"0000"===t.data.code?e.$message({message:"添加成功",type:"success"}):e.$message.error(t.data.result),e.isDisabled=!1,e.resourcesDialogVisible=!1,e.$refs.resourcesForm.resetFields(),e.initList(),e.getResources()}))})},getResources:function(){var e=this;(function(e){var t=new URLSearchParams;return t.append("menuId",e),Object(i.a)({url:"system/sysResources/findResourcesByMenuId",method:"post",data:t})})(this.resourcesForm.menuId).then(function(t){"0000"===t.data.code?e.tableData=t.data.data:e.$message.error(t.data.result)})},handleCreate:function(){var e=this;this.resourcesForm.resourcesName=void 0,this.resourcesForm.resourcesUrl=void 0,this.dialogStatus="新增功能",this.resourcesDialogVisible=!0,this.$nextTick(function(){e.$refs.resourcesForm.clearValidate()})},cencalEdit:function(e){var t=this;n(this.parentId).then(function(e){"0000"===e.data.code?(t.subForm.menuData=e.data.data,t.$refs.subForm.clearValidate()):t.$message.error(e.data.result),t.initList()})},menuDown:function(e,t){var s=this;if(t===this.subForm.menuData.length-1)alert("已经是最下面了");else{var a=this.subForm.menuData[t+1];this.subForm.menuData[t+1]=this.subForm.menuData[t],this.subForm.menuData[t]=a;var r=this.subForm.menuData[t+1].sort;this.subForm.menuData[t+1].sort=this.subForm.menuData[t].sort,this.subForm.menuData[t].sort=r,this.isMove=!1,this.$nextTick(function(){s.isMove=!0})}},menuUp:function(e,t){var s=this;if(0===t)alert("已经是最上面了");else{var a=this.subForm.menuData[t-1],r=this.subForm.menuData[t-1].sort;this.subForm.menuData[t-1].sort=this.subForm.menuData[t].sort,this.subForm.menuData[t].sort=r,this.subForm.menuData[t-1]=this.subForm.menuData[t],this.subForm.menuData[t]=a,this.isMove=!1,this.$nextTick(function(){s.isMove=!0})}},submitMenuInfo:function(e){var t=this,s=[];this.subForm.menuData.forEach(function(e){s.push({id:e.id,menuName:e.label,menuUrl:e.menuUrl,sort:e.sort})}),this.$refs.subForm.validate(function(e){e&&(t.isDisabled=!0,function(e){return Object(i.a)({url:"system/sysMenu/updateBatch",method:"post",data:e})}({sysMenuSortList:s}).then(function(e){"0000"===e.data.code?t.$message({message:"保存成功",type:"success"}):t.$message.error(e.data.result),t.isDisabled=!1,t.initList()}))})},handleNodeClick:function(e){this.currentId=e.id,this.isRight=!0,this.parentId=e.id,"1"===e.isDir?(this.currentMenuName=e.label,this.isShowMenuDir=!1,this.subForm.menuData=e.children,null===e.children?(this.isShowInfo=!1,this.isData=!0):(this.isData=!1,this.isShowInfo=!0)):"0"===e.isDir&&(this.tableData=e.resourcesList,this.isData=!1,this.isShowMenuDir=!0,this.isShowInfo=!1,this.isShowTable=!0,this.dataForm.menuName=e.label,this.dataForm.menuUrl=e.menuUrl,this.resourcesForm.menuId=e.id)},deleteMenu:function(e){var t=this;this.$confirm("此操作将永久删除这个菜单的数据及其子菜单数据, 是否继续?","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){(function(e){var t=new URLSearchParams;return t.append("id",e),Object(i.a)({url:"system/sysMenu/delete",method:"post",data:t})})(e).then(function(s){"0000"===s.data.code?(t.$message({message:"删除成功",type:"success"}),t.initList(),t.currentId===e?t.isRight=!1:t.isRight=!0):t.$message.error(s.data.result)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},updateData:function(){var e=this;this.$refs.menuForm.validate(function(t){t&&(e.isDisabled=!0,function(e){return Object(i.a)({url:"system/sysMenu/update",method:"post",data:e})}(e.menuForm).then(function(t){"0000"===t.data.code?(e.$message({message:"编辑成功",type:"success"}),"0"===e.currentData.isDir?(e.dataForm.menuName=e.menuForm.menuName,e.dataForm.menuUrl=e.menuForm.menuUrl):"1"===e.currentData.isDir&&(e.currentMenuName=e.menuForm.menuName)):e.$message.error(t.data.result),e.isDisabled=!1,e.$refs.menuForm.resetFields(),e.menuDialogVisible=!1,e.initList()}))})},editMenu:function(e){var t=this;this.isTrue=!0,this.dialogStatus="编辑",this.currentData=e,this.visible=!1,this.oldMenuName=e.label,this.menuForm.id=e.id,this.menuDialogVisible=!0,this.menuForm.menuName=e.label,e.parentName?this.menuForm.parentId=e.parentId:this.menuForm.parentId="1","1"===e.isDir?(this.isShow=!1,this.menuForm.menuUrl="/"):"0"===e.isDir&&(this.isShow=!0,this.menuForm.menuUrl=e.menuUrl),this.$nextTick(function(){t.$refs.menuForm.clearValidate()})},createData:function(){var e=this;this.$refs.menuForm.validate(function(t){t&&(e.isDisabled=!0,"1"===e.radio?function(e){return Object(i.a)({url:"system/sysMenu/addMenuDir",method:"post",data:e})}({menuName:e.menuForm.menuName,menuUrl:e.menuForm.menuUrl,parentId:e.menuForm.parentId}).then(function(t){"0000"===t.data.code?(e.$message({message:"添加成功",type:"success"}),e.initList(),e.updataRight()):e.$message.error(t.data.result),e.isDisabled=!1}):"2"===e.radio&&function(e){return Object(i.a)({url:"system/sysMenu/addMenu",method:"post",data:e})}({menuName:e.menuForm.menuName,menuUrl:e.menuForm.menuUrl,parentId:e.menuForm.parentId}).then(function(t){"0000"===t.data.code?(e.$message({message:"添加成功",type:"success"}),e.initList(),e.updataRight()):e.$message.error(t.data.result),e.isDisabled=!1}),e.$refs.menuForm.resetFields(),e.menuDialogVisible=!1)})},updataRight:function(){var e=this;"0"===this.location&&n(this.checkoutId).then(function(t){"0000"===t.data.code?e.subForm.menuData=t.data.data:e.$message.error(t.data.result)})},addMenu:function(e){var t=this;this.radio="1",this.location="1",this.isTrue=!1,this.isShow=!1,this.dialogStatus="新增",this.menuDialogVisible=!0,this.menuForm.menuName=void 0,this.menuId=e.id,this.checkoutId=e.id,this.checkoutParentId=e.parentId,e.parentName?this.menuForm.parentId=e.parentId:this.menuForm.parentId="1","0"===e.isDir?this.visible=!1:"1"===e.isDir&&(this.visible=!0),this.menuForm.menuUrl="/",this.$nextTick(function(){t.$refs.menuForm.clearValidate()})},initList:function(){var e=this;this.listLoading=!0,Object(i.a)({url:"system/sysMenu/list",method:"post"}).then(function(t){"0000"===t.data.code?e.menuList=t.data.data:e.$message.error(t.data.result),e.listLoading=!1})}}},u=(s("0BXH"),s("KHd+")),l=Object(u.a)(o,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"menuManagement"},[s("div",{staticClass:"menu-left"},[s("el-tree",{attrs:{data:e.menuList,"expand-on-click-node":!1,"default-expand-all":"","node-key":"id"},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.node,r=t.data;return s("span",{staticClass:"custom-tree-node"},[s("span",[s("i",{class:a.icon,staticStyle:{"margin-right":"3px"}}),e._v(e._s(a.label)+"\n        ")]),e._v(" "),s("span",{staticStyle:{"margin-left":"20px"}},[s("i",{staticClass:"el-icon-plus",on:{click:function(){return e.addMenu(r)}}}),e._v(" "),s("i",{staticClass:"el-icon-edit",on:{click:function(){return e.editMenu(r)}}}),e._v(" "),s("i",{staticClass:"el-icon-delete",on:{click:function(){return e.deleteMenu(r.id)}}})])])}}])})],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isRight,expression:"isRight"}],staticClass:"menu-right bgc"},[e.isData?s("div",{staticClass:"noData"},[e._v("没有子菜单")]):e._e(),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowInfo,expression:"isShowInfo"}],staticClass:"menuInfo"},[s("div",{staticClass:"menuInfo-title"},[e._v("下级菜单")]),e._v(" "),s("div",{staticClass:"menu-content"},[s("span",[e._v(e._s(e.currentMenuName))]),e._v(" "),e.isMove?s("el-form",{ref:"subForm",attrs:{rules:e.rules,model:e.subForm,"label-width":"100px"}},[e._l(e.subForm.menuData,function(t,a){return s("el-form-item",{key:a,attrs:{prop:"menuData."+a+".label",rules:e.menuDataRules.label}},[s("el-input",{on:{blur:e.checkoutSubName},model:{value:t.label,callback:function(s){e.$set(t,"label",s)},expression:"item.label"}}),s("a",{staticClass:"fa fa-long-arrow-up",attrs:{href:"javascript:;"},on:{click:function(s){e.menuUp(t,a)}}}),s("a",{staticClass:"fa fa-long-arrow-down",attrs:{href:"javascript:;"},on:{click:function(s){e.menuDown(t,a)}}})],1)}),e._v(" "),s("el-form-item",[s("el-button",{attrs:{disabled:e.isDisabled,type:"primary"},on:{click:function(t){e.submitMenuInfo("subForm")}}},[e._v("保存")]),e._v(" "),s("el-button",{on:{click:function(t){e.cencalEdit("subForm")}}},[e._v("取消")])],1)],2):e._e()],1)]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowMenuDir,expression:"isShowMenuDir"}],staticClass:"menuDirInfo"},[s("div",[s("span",[e._v("页面名称：")]),e._v(" "+e._s(e.dataForm.menuName))]),e._v(" "),s("div",{staticClass:"urlAddress"},[s("span",[e._v("url地址：")]),e._v(" "+e._s(e.dataForm.menuUrl))]),e._v(" "),s("div",{staticClass:"menuDirInfo-content"},[s("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("新增功能")]),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,fit:"",border:""}},[s("el-table-column",{attrs:{prop:"resourcesName",align:"center",label:"功能名称"}}),e._v(" "),s("el-table-column",{attrs:{prop:"resourcesUrl",align:"center","min-width":"200",label:"链接"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(s){e.handleUpdate(t.row)}}},[e._v("编辑")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){e.deleteResourcesName(t.row.id)}}},[e._v("删除")])]}}])})],1)],1)])]),e._v(" "),s("el-dialog",{attrs:{visible:e.menuDialogVisible,title:e.dialogStatus,width:"500px"},on:{"update:visible":function(t){e.menuDialogVisible=t}}},[s("el-form",{ref:"menuForm",attrs:{rules:e.rules,model:e.menuForm,"label-width":"100px"}},[s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],attrs:{label:"新增位置:",prop:"location"}},[s("el-radio",{attrs:{label:"1"},model:{value:e.location,callback:function(t){e.location=t},expression:"location"}},[e._v("同级菜单")]),e._v(" "),s("el-radio",{attrs:{label:"0"},model:{value:e.location,callback:function(t){e.location=t},expression:"location"}},[e._v("子菜单")])],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.isTrue,expression:"!isTrue"}],attrs:{label:"菜单类型:",prop:"type"}},[s("el-radio",{attrs:{label:"1"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v("目录")]),e._v(" "),s("el-radio",{attrs:{label:"2"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v("页面")])],1),e._v(" "),s("el-form-item",{attrs:{label:"菜单名称:",prop:"menuName"}},[s("el-input",{staticStyle:{width:"340px"},attrs:{maxlength:"20"},model:{value:e.menuForm.menuName,callback:function(t){e.$set(e.menuForm,"menuName",t)},expression:"menuForm.menuName"}})],1),e._v(" "),e.isShow?s("el-form-item",{attrs:{label:"url地址:",prop:"menuUrl"}},[s("el-input",{staticStyle:{width:"340px"},attrs:{maxlength:"150"},model:{value:e.menuForm.menuUrl,callback:function(t){e.$set(e.menuForm,"menuUrl",t)},expression:"menuForm.menuUrl"}})],1):e._e(),e._v(" "),s("el-form-item",{staticClass:"footer",attrs:{"label-width":"0px"}},[s("el-button",{attrs:{disabled:e.isDisabled,type:"primary"},on:{click:function(t){"新增"===e.dialogStatus?e.createData():e.updateData()}}},[e._v("保存")]),e._v(" "),s("el-button",{on:{click:function(t){e.menuDialogVisible=!1}}},[e._v("取消")])],1)],1)],1),e._v(" "),s("el-dialog",{attrs:{visible:e.resourcesDialogVisible,title:e.dialogStatus,width:"500px"},on:{"update:visible":function(t){e.resourcesDialogVisible=t}}},[s("el-form",{ref:"resourcesForm",staticClass:"resourcesBox",attrs:{rules:e.rules,model:e.resourcesForm,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"功能名称:",prop:"resourcesName"}},[s("el-input",{attrs:{maxlength:"20"},model:{value:e.resourcesForm.resourcesName,callback:function(t){e.$set(e.resourcesForm,"resourcesName",t)},expression:"resourcesForm.resourcesName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"功能地址:",prop:"resourcesUrl"}},[s("el-input",{staticStyle:{width:"340px"},attrs:{maxlength:"150"},model:{value:e.resourcesForm.resourcesUrl,callback:function(t){e.$set(e.resourcesForm,"resourcesUrl",t)},expression:"resourcesForm.resourcesUrl"}})],1),e._v(" "),s("el-form-item",{staticClass:"footer",attrs:{"label-width":"0px"}},[s("el-button",{attrs:{disabled:e.isDisabled,type:"primary"},on:{click:function(t){"新增功能"===e.dialogStatus?e.createResources():e.updateResources()}}},[e._v("保存")]),e._v(" "),s("el-button",{on:{click:function(t){e.resourcesDialogVisible=!1}}},[e._v("取消")])],1)],1)],1)],1)},[],!1,null,null,null);l.options.__file="menuManagement.vue";t.default=l.exports},gGBZ:function(e,t,s){}}]);