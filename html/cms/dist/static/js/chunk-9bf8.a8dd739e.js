(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-9bf8"],{AL8P:function(e,t,s){"use strict";var r=s("LTf9");s.n(r).a},L2WX:function(e,t,s){"use strict";s.r(t);var r=s("t3Un");var a={filters:{statusFilter:function(e){return{0:"未生效",1:"生效"}[e]}},data:function(){var e=this;return{isDisabled:!1,numberTotal:0,numberRows:10,numberPage:1,moveArr:0,oldGroupName:void 0,userGroupId:void 0,userTotal:null,userIds:[],userData:[],userLoading:!1,roleLoading:!1,groupId:void 0,dialogStatus:void 0,tableKey:0,userRows:10,userPage:1,listLoading:!1,roleData:[],roleIds:[],total:null,usergroupList:[],listQuery:{groupName:void 0,status:void 0,rows:10,page:1},userGroupdialogFormVisible:!1,userdialogVisible:!1,roledialogVisible:!1,statusOptions:["未生效","生效"],userGroupform:{id:"",groupName:void 0,status:"生效"},rules:{groupName:[{required:!0,message:"请输入用户组名称",trigger:"blur"},{validator:function(t,s,a){/^[\u4e00-\u9fa5\w]{1,20}$/.test(s)?e.oldGroupName!==e.userGroupform.groupName?function(e){var t=new URLSearchParams;return t.append("groupName",e),Object(r.a)({url:"system/sysGroup/checkGroupName",method:"post",data:t})}(e.userGroupform.groupName).then(function(e){"0000"===e.data.code&&("success"===e.data.data?a():a(new Error("用户组名称已重复")))}):a():a(new Error("名称只允许数字、中文、字母及下划线"))},trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]}}},created:function(){this.initList()},methods:{handleRoleCurrentChange:function(e){console.log(this.numberTotal),this.numberTotal-this.moveArr>(e-1)*this.numberRows?this.numberPage=e:this.numberPage=e-1,this.roledialogVisible=!0,this.getRole()},handleRoleChange:function(e,t,s){var a=this;this.roleIds=e,"left"===t?this.moveArr=-s.length:"right"===t&&(this.moveArr=s.length),function(e){return Object(r.a)({url:"system/sysGroup/roleGroupAuthorization",method:"post",data:e})}({groupId:this.groupId,roleIds:e}).then(function(e){"0000"===e.data.code?a.$message({message:"授权成功",type:"success"}):a.$message.error(e.data.result),a.initList()})},showRoleDialog:function(e){this.numberPage=1,this.roleLoading=!0,this.groupId=e,this.roledialogVisible=!0,this.getRole()},getRole:function(){var e=this;(function(e){return Object(r.a)({url:"system/sysGroup/selectGroupRoleAndOtherRole",method:"post",data:e})})({groupId:this.groupId,page:this.numberPage,rows:this.numberRows}).then(function(t){if("0000"===t.data.code){var s=[],r=[];e.numberTotal=t.data.data.total,t.data.data.rows.otherRoleList.forEach(function(e,t){s.push({label:e.roleName,key:e.id})}),t.data.data.rows.roleOfGroupList.forEach(function(e){r.push(e.id)}),e.roleData=s,e.roleIds=r,e.roleLoading=!1}else e.$message.error(t.data.result)})},showuserGruopDialog:function(e){this.userPage=1,this.userLoading=!0,this.userGroupId=e.id,this.userdialogVisible=!0,this.getUser()},getUser:function(){var e=this;(function(e){return Object(r.a)({url:"system/sysGroup/findOtherUserByPage",method:"post",data:e})})({groupId:this.userGroupId,page:this.userPage,rows:this.userRows}).then(function(t){var s=[],r=[];e.userTotal=t.data.data.total,t.data.data.rows.userList.forEach(function(e,t){s.push({label:e.name,key:e.id})}),t.data.data.rows.userAllOfGroup.forEach(function(e,t){r.push(e.id)}),e.userData=s,e.userIds=r,e.userLoading=!1})},handleUserCurrentChange:function(e){this.userTotal-this.moveArr>(e-1)*this.userRows?this.userPage=e:this.userPage=e-1,this.userLoading=!0,this.getUser()},handleUserChange:function(e,t,s){var a=this;console.log(e),this.userIds=e,"left"===t?this.moveArr=-s.length:"right"===t&&(this.moveArr=s.length),function(e){return Object(r.a)({url:"system/sysGroup/userGroupAuthorization",method:"post",data:e})}({groupId:this.userGroupId,userIds:e}).then(function(e){"0000"===e.data.code?a.$message({message:"授权成功",type:"success"}):a.$message.error(e.data.result),a.initList()})},selecteUserStatus:function(e){this.listQuery.status=e},handleFilter:function(){this.listQuery.page=1,this.initList()},resetuserGroupform:function(){this.userGroupform={groupName:void 0,status:void 0}},handleCreate:function(){var e=this;this.resetuserGroupform(),this.dialogStatus="新增用户组",this.userGroupdialogFormVisible=!0,this.$nextTick(function(){e.$refs.userGroupform.clearValidate()})},createUserData:function(){var e=this;this.$refs.userGroupform.validate(function(t){t&&(e.isDisabled=!0,function(e){return Object(r.a)({url:"system/sysGroup/add",method:"post",data:e})}(e.userGroupform).then(function(t){"0000"===t.data.code?e.$message({message:"添加成功",type:"success"}):e.$message.error(t.data.result),e.isDisabled=!1,e.userGroupdialogFormVisible=!1,e.$refs.userGroupform.resetFields(),e.initList()}))})},handleUpdate:function(e){var t=this;this.oldGroupName=e.groupName,this.userGroupdialogFormVisible=!0,this.dialogStatus="编辑用户组",this.userGroupform.groupName=e.groupName,this.userGroupform.status=parseInt(e.status),this.userGroupform.id=e.id,this.$nextTick(function(){t.$refs.userGroupform.clearValidate()})},updateData:function(){var e=this;this.$refs.userGroupform.validate(function(t){t&&(e.isDisabled=!0,e.userGroupdialogFormVisible=!1,function(e){return Object(r.a)({url:"system/sysGroup/update",method:"post",data:e})}(e.userGroupform).then(function(t){"0000"===t.data.code?e.$message({message:"编辑成功",type:"success"}):e.$message.error(t.data.result),e.isDisabled=!1,e.$refs.userGroupform.resetFields(),e.initList()}))})},deleteUsergroup:function(e){var t=this;this.$confirm("此操作将永久删除这条数据, 是否继续?","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){(function(e){var t=new URLSearchParams;return t.append("groupIds",e),Object(r.a)({url:"system/sysGroup/delete",method:"post",data:t})})(e.id).then(function(e){"0000"===e.data.code?(t.$message({message:"删除成功",type:"success"}),t.total%t.listQuery.rows==1&&(t.listQuery.page=t.listQuery.page-1),t.initList()):t.$message.error(e.data.result)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},initList:function(){var e=this;this.listLoading=!0,function(e){return Object(r.a)({url:"system/sysGroup/list",method:"post",data:e})}(this.listQuery).then(function(t){"0000"===t.data.code?(e.usergroupList=t.data.data.rows,e.total=t.data.data.total,0===e.usergroupList.length&&e.total>0&&(e.listQuery.page=1,e.initList())):e.$message.error(t.data.result),e.listLoading=!1})},handleSizeChange:function(e){this.listQuery.rows=e,this.initList()},handleCurrentChange:function(e){this.listQuery.page=e,this.initList()}}},o=(s("AL8P"),s("KHd+")),i=Object(o.a)(a,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"management"},[s("div",{staticClass:"filter-container"},[s("el-form",{attrs:{inline:!0,model:e.listQuery}},[s("el-form-item",{attrs:{label:"用户组名称:"}},[s("el-input",{staticClass:"filter-item",attrs:{maxlength:"20",placeholder:"请输入名称",clearable:""},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleFilter(t):null}},model:{value:e.listQuery.groupName,callback:function(t){e.$set(e.listQuery,"groupName",t)},expression:"listQuery.groupName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"状态:"}},[s("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择",clearable:""},on:{change:e.selecteUserStatus},model:{value:e.listQuery.status,callback:function(t){e.$set(e.listQuery,"status",t)},expression:"listQuery.status"}},e._l(e.statusOptions,function(e,t){return s("el-option",{key:e,attrs:{label:e,value:t}})}))],1),e._v(" "),s("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("搜索")]),e._v(" "),s("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("新增")])],1)],1),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%",height:"100%"},attrs:{data:e.usergroupList,border:"",fit:"","highlight-current-row":""}},[s("el-table-column",{attrs:{type:"index",width:"60",label:"序号",align:"center"}}),e._v(" "),s("el-table-column",{attrs:{label:"用户组名称",align:"center",prop:"groupName"}}),e._v(" "),s("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"拥有用户",align:"center","min-width":"100",prop:"sysTUserList"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.sysTUserList.join("、"))+"\n    ")]}}])}),e._v(" "),s("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:"角色名称",align:"center",prop:"sysRoleList","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.sysRoleList.join("、"))+"\n      ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"创建时间",width:"150",align:"center",prop:"creationTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e._f("parseTime")(t.row.createTime,"{y}-{m}-{d} {h}:{i}"))+"\n      ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"状态",align:"center",prop:"status"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{class:1==t.row.status?"text-green":"text-red"},[e._v(e._s(e._f("statusFilter")(t.row.status)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center","min-width":"300","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(s){e.handleUpdate(t.row)}}},[e._v("编辑")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(s){e.showuserGruopDialog(t.row)}}},[e._v("授权用户")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(s){e.showRoleDialog(t.row.id)}}},[e._v("授权角色")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){e.deleteUsergroup(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),s("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],staticClass:"tablePagination",attrs:{"current-page":e.listQuery.page,"page-sizes":[5,10,20,30,50],"page-size":e.listQuery.rows,total:e.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),s("el-dialog",{attrs:{visible:e.userGroupdialogFormVisible,title:e.dialogStatus,width:"400px"},on:{"update:visible":function(t){e.userGroupdialogFormVisible=t}}},[s("el-form",{ref:"userGroupform",staticStyle:{"max-width":"300px","margin-left":"20px"},attrs:{rules:e.rules,model:e.userGroupform,"label-position":"right","label-width":"80px"}},[s("el-form-item",{attrs:{label:"用户组:",prop:"groupName"}},[s("el-input",{attrs:{maxlength:"20",clearable:""},model:{value:e.userGroupform.groupName,callback:function(t){e.$set(e.userGroupform,"groupName","string"==typeof t?t.trim():t)},expression:"userGroupform.groupName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"状态:",prop:"status"}},[s("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择",clearable:""},model:{value:e.userGroupform.status,callback:function(t){e.$set(e.userGroupform,"status",t)},expression:"userGroupform.status"}},e._l(e.statusOptions,function(e,t){return s("el-option",{key:t,attrs:{label:e,value:t}})}))],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer",align:"center"},slot:"footer"},[s("el-button",{attrs:{disabled:e.isDisabled,type:"primary"},on:{click:function(t){"新增用户组"===e.dialogStatus?e.createUserData():e.updateData()}}},[e._v("提交")]),e._v(" "),s("el-button",{on:{click:function(t){e.userGroupdialogFormVisible=!1}}},[e._v("取消")])],1)],1),e._v(" "),s("el-dialog",{attrs:{visible:e.roledialogVisible,title:"授权角色",width:"800px"},on:{"update:visible":function(t){e.roledialogVisible=t}}},[s("el-transfer",{directives:[{name:"loading",rawName:"v-loading",value:e.roleLoading,expression:"roleLoading"}],staticClass:"box",attrs:{data:e.roleData,titles:["其他角色","用户组拥有角色"],filterable:"","filter-placeholder":"请输入角色名称"},on:{change:e.handleRoleChange},model:{value:e.roleIds,callback:function(t){e.roleIds=t},expression:"roleIds"}},[s("span",{attrs:{slot:"left-footer",size:"small"},slot:"left-footer"},[s("el-pagination",{attrs:{"current-page":e.numberPage,"pager-count":5,total:e.numberTotal,background:"",layout:"prev, pager, next"},on:{"current-change":e.handleRoleCurrentChange}})],1),e._v(" "),s("span",{attrs:{slot:"right-footer",size:"small"},slot:"right-footer"})])],1),e._v(" "),s("el-dialog",{attrs:{visible:e.userdialogVisible,title:"授权用户",width:"800px"},on:{"update:visible":function(t){e.userdialogVisible=t}}},[s("el-transfer",{directives:[{name:"loading",rawName:"v-loading",value:e.userLoading,expression:"userLoading"}],staticClass:"box",attrs:{data:e.userData,titles:["其他用户","用户组拥有用户"],"target-order":"unshift",filterable:"","filter-placeholder":"请输入用户名称"},on:{change:e.handleUserChange},model:{value:e.userIds,callback:function(t){e.userIds=t},expression:"userIds"}},[s("span",{attrs:{slot:"left-footer",size:"small"},slot:"left-footer"},[s("el-pagination",{attrs:{"page-size":e.userRows,"current-page":e.userPage,"pager-count":5,total:e.userTotal,background:"",layout:"prev, pager, next"},on:{"current-change":e.handleUserCurrentChange}})],1),e._v(" "),s("span",{attrs:{slot:"right-footer",size:"small"},slot:"right-footer"})])],1)],1)},[],!1,null,null,null);i.options.__file="userGroupManagement.vue";t.default=i.exports},LTf9:function(e,t,s){}}]);