(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-bd1a"],{"1oRP":function(e,t,i){"use strict";var s=i("SPw+");i.n(s).a},FSpR:function(e,t,i){"use strict";i.r(t);var s=i("t3Un");var a={data:function(){var e=this;return{isDisabled:!1,data3:[],data2:[],defaultProps:{children:"children",label:"label"},fileGroupData:[],fileGroupIds:[],fileGroupLoading:!1,fileGroupdialogVisible:!1,menuDialogVisible:!1,menuLoading:!1,moveArr:0,numberPage:1,numberRows:10,numberTotal:0,permissionId:void 0,roleData:[],roleIds:[],roleLoading:!1,roledialogVisible:!1,oldPermissionName:void 0,permissionform:{id:"",permissionName:void 0,status:void 0},dialogStatus:void 0,permissiondialogFormVisible:!1,permissionList:[],permissionLoading:!1,listQuery:{page:1,rows:10,permissionName:void 0,status:void 0},total:void 0,statusOptions:["未生效","生效"],rules:{permissionName:[{required:!0,message:"请输入权限名称",trigger:"blur"},{validator:function(t,i,a){/^[\u4e00-\u9fa5\w]{1,20}$/.test(i)?e.oldPermissionName!==e.permissionform.permissionName?function(e){var t=new URLSearchParams;return t.append("permissionName",e),Object(s.a)({url:"system/sysPermission/checkPerssionName",method:"post",data:t})}(e.permissionform.permissionName).then(function(e){"0000"===e.data.code&&("success"===e.data.data?a():a(new Error("权限名称已重复")))}):a():a(new Error("名称只允许数字、中文、字母及下划线"))},trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"blur"}]}}},created:function(){this.initList()},methods:{getCheckedKeys:function(){var e=this;(function(e){return Object(s.a)({url:"system/sysPermission/addMenuAndResourcesToPermission",method:"post",data:e})})({menuAndResourcesIds:this.$refs.tree.getCheckedKeys(),permissionId:this.permissionId}).then(function(t){"0000"===t.data.code?e.$message({message:"授权成功",type:"success"}):e.$message.error(t.data.result),e.menuDialogVisible=!1})},showMenuDialog:function(e){var t=this;this.permissionId=e,this.menuDialogVisible=!0,this.menuLoading=!0,function(e){var t=new URLSearchParams;return t.append("permissionId",e),Object(s.a)({url:"system/sysPermission/getMenuAndResources",method:"post",data:t})}(e).then(function(e){"0000"===e.data.code?(t.data2=e.data.data.sysMenuTreeVOList,t.data3=e.data.data.menuAndResourcesIds):t.$message.error(e.data.result),t.menuLoading=!1})},handleFileGroupCurrentChange:function(e){this.numberTotal-this.moveArr>(e-1)*this.numberRows?this.numberPage=e:this.numberPage=e-1,this.fileGroupdialogVisible=!0,this.getFileGroup()},handleFileGroupChange:function(e,t,i){var a=this;this.fileGroupIds=e,"left"===t?this.moveArr=-i.length:"right"===t&&(this.moveArr=i.length),function(e){return Object(s.a)({url:"system/sysPermission/addFileGroupToPermission",method:"post",data:e})}({permissionId:this.permissionId,fileGroupIds:e}).then(function(e){"0000"===e.data.code?a.$message({message:"授权成功",type:"success"}):a.$message.error(e.data.result)})},showFileGroupDialog:function(e){this.numberPage=1,this.fileGroupLoading=!0,this.permissionId=e,this.fileGroupdialogVisible=!0,this.getFileGroup()},getFileGroup:function(){var e=this;(function(e){return Object(s.a)({url:"system/sysPermission/findFileGroupOfPermission",method:"post",data:e})})({permissionId:this.permissionId,page:this.numberPage,rows:this.numberRows}).then(function(t){var i=[],s=[];e.numberTotal=t.data.data.total,t.data.data.rows.otherFileGroupList.forEach(function(e,t){i.push({label:e.fileGroupName,key:e.id})}),t.data.data.rows.sysFileGroupOfPermissionList.forEach(function(e){s.push(e.id)}),e.fileGroupData=i,e.fileGroupIds=s,e.fileGroupLoading=!1})},handleRoleCurrentChange:function(e){this.numberTotal-this.moveArr>(e-1)*this.numberRows?this.numberPage=e:this.numberPage=e-1,this.roledialogVisible=!0,this.getRole()},handleRoleChange:function(e,t,i){var a=this;this.roleIds=e,"left"===t?this.moveArr=-i.length:"right"===t&&(this.moveArr=i.length),function(e){return Object(s.a)({url:"system/sysPermission/addRoleToPermission",method:"post",data:e})}({permissionId:this.permissionId,roleIds:e}).then(function(e){"0000"===e.data.code?a.$message({message:"授权成功",type:"success"}):a.$message.error(e.data.result)})},showRoleDialog:function(e){this.numberPage=1,this.roleLoading=!0,this.permissionId=e,this.roledialogVisible=!0,this.getRole()},getRole:function(){var e=this;(function(e){return Object(s.a)({url:"system/sysPermission/findRoleOfPermission",method:"post",data:e})})({permissionId:this.permissionId,page:this.numberPage,rows:this.numberRows}).then(function(t){var i=[],s=[];e.numberTotal=t.data.data.total,t.data.data.rows.otherRoleList.forEach(function(e,t){i.push({label:e.roleName,key:e.id})}),t.data.data.rows.roleOfPermissionList.forEach(function(e){s.push(e.id)}),e.roleData=i,e.roleIds=s,e.roleLoading=!1})},deletePermission:function(e){var t=this;this.$confirm("此操作将永久删除这条数据, 是否继续?","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){(function(e){var t=new URLSearchParams;return t.append("ids",e),Object(s.a)({url:"system/sysPermission/delete",method:"post",data:t})})(e).then(function(e){"0000"===e.data.code?(t.$message({message:"删除成功",type:"success"}),t.total%t.listQuery.rows==1&&(t.listQuery.page=t.listQuery.page-1),t.initList()):t.$message.error(e.data.result)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},updateData:function(){var e=this;this.$refs.permissionform.validate(function(t){t&&(e.isDisabled=!0,function(e){return Object(s.a)({url:"system/sysPermission/update",method:"post",data:e})}(e.permissionform).then(function(t){"0000"===t.data.code?e.$message({message:"编辑成功",type:"success"}):e.$message.error(t.data.result),e.isDisabled=!1,e.permissiondialogFormVisible=!1,e.$refs.permissionform.resetFields(),e.initList()}))})},handleUpdate:function(e){var t=this;this.permissiondialogFormVisible=!0,this.dialogStatus="编辑权限",this.oldPermissionName=e.permissionName,this.permissionform.permissionName=e.permissionName,this.permissionform.status=parseInt(e.status),this.permissionform.id=e.id,this.$nextTick(function(){t.$refs.permissionform.clearValidate()})},createPermissionData:function(){var e=this;this.$refs.permissionform.validate(function(t){t&&(e.isDisabled=!0,function(e){return Object(s.a)({url:"system/sysPermission/add",method:"post",data:e})}(e.permissionform).then(function(t){"0000"===t.data.code?(e.$message({message:"添加成功",type:"success"}),e.permissiondialogFormVisible=!1):e.$message.error(t.data.result),e.isDisabled=!1,e.$refs.permissionform.resetFields(),e.initList()}))})},handleCreate:function(){var e=this;this.resetPermissionform(),this.dialogStatus="新增权限",this.permissiondialogFormVisible=!0,this.$nextTick(function(){e.$refs.permissionform.clearValidate()})},resetPermissionform:function(){this.permissionform={permissionName:void 0,status:void 0}},handleFilter:function(){this.listQuery.page=1,this.initList()},selecteUserStatus:function(e){this.listQuery.status=e},initList:function(){var e=this;this.permissionLoading=!0,function(e){return Object(s.a)({url:"system/sysPermission/list",method:"post",data:e})}(this.listQuery).then(function(t){"0000"===t.data.code?(e.permissionList=t.data.data.rows,e.total=t.data.data.total,0===e.permissionList.length&&e.total>0&&(e.listQuery.page=1,e.initList())):e.$message.error(t.data.result),e.permissionLoading=!1})},handleSizeChange:function(e){this.listQuery.rows=e,this.initList()},handleCurrentChange:function(e){this.listQuery.page=e,this.initList()}}},o=(i("1oRP"),i("KHd+")),r=Object(o.a)(a,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"permissionManagement"},[i("div",{staticClass:"filter-container"},[i("el-form",{attrs:{inline:!0,model:e.listQuery}},[i("el-form-item",{attrs:{label:"权限名称:"}},[i("el-input",{staticClass:"filter-item",attrs:{placeholder:"请输入权限名称",maxlength:"20",clearable:""},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleFilter(t):null}},model:{value:e.listQuery.permissionName,callback:function(t){e.$set(e.listQuery,"permissionName",t)},expression:"listQuery.permissionName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"状态:"}},[i("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择",clearable:""},on:{change:e.selecteUserStatus},model:{value:e.listQuery.status,callback:function(t){e.$set(e.listQuery,"status",t)},expression:"listQuery.status"}},e._l(e.statusOptions,function(e,t){return i("el-option",{key:t,attrs:{label:e,value:t}})}))],1),e._v(" "),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("搜索")]),e._v(" "),i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("新增")])],1)],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.permissionLoading,expression:"permissionLoading"}],staticStyle:{width:"100%",height:"100%"},attrs:{data:e.permissionList,border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{type:"index",align:"center",label:"序号",width:"60"}}),e._v(" "),i("el-table-column",{attrs:{label:"权限名称",align:"center",prop:"permissionName"}}),e._v(" "),i("el-table-column",{attrs:{label:"创建时间","min-width":"150",align:"center",prop:"creationTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e._f("parseTime")(t.row.createTime,"{y}-{m}-{d} {h}:{i}"))+"\n      ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"状态",align:"center",prop:"status"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{class:1==t.row.status?"text-green":"text-red"},[e._v(e._s(0==t.row.status?"未生效":"生效"))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",align:"center","min-width":"280","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){e.handleUpdate(t.row)}}},[e._v("编辑")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){e.showRoleDialog(t.row.id)}}},[e._v("授权角色")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){e.showMenuDialog(t.row.id)}}},[e._v("授权菜单")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){e.showFileGroupDialog(t.row.id)}}},[e._v("授权文件组")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){e.deletePermission(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],staticClass:"tablePagination",attrs:{"current-page":e.listQuery.page,"page-sizes":[10,20,30,40],"page-size":e.listQuery.rows,total:e.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),i("el-dialog",{attrs:{visible:e.permissiondialogFormVisible,title:e.dialogStatus,width:"400px"},on:{"update:visible":function(t){e.permissiondialogFormVisible=t}}},[i("el-form",{ref:"permissionform",staticStyle:{"max-width":"300px","margin-left":"20px"},attrs:{rules:e.rules,model:e.permissionform,"label-position":"right","label-width":"80px"}},[i("el-form-item",{attrs:{label:"权限名称",prop:"permissionName"}},[i("el-input",{attrs:{maxlength:"20",clearable:""},model:{value:e.permissionform.permissionName,callback:function(t){e.$set(e.permissionform,"permissionName",t)},expression:"permissionform.permissionName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"状态",prop:"status"}},[i("el-select",{staticClass:"filter-item",attrs:{placeholder:"请选择",clearable:""},model:{value:e.permissionform.status,callback:function(t){e.$set(e.permissionform,"status",t)},expression:"permissionform.status"}},e._l(e.statusOptions,function(e,t){return i("el-option",{key:t,attrs:{label:e,value:t}})}))],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer",align:"center"},slot:"footer"},[i("el-button",{attrs:{disabled:e.isDisabled,type:"primary"},on:{click:function(t){"新增权限"===e.dialogStatus?e.createPermissionData():e.updateData()}}},[e._v("提交")]),e._v(" "),i("el-button",{on:{click:function(t){e.permissiondialogFormVisible=!1}}},[e._v("取消")])],1)],1),e._v(" "),i("el-dialog",{attrs:{visible:e.roledialogVisible,title:"授权角色",width:"800px"},on:{"update:visible":function(t){e.roledialogVisible=t}}},[i("el-transfer",{directives:[{name:"loading",rawName:"v-loading",value:e.roleLoading,expression:"roleLoading"}],staticClass:"box",attrs:{data:e.roleData,titles:["其他角色","权限拥有角色"],filterable:"","filter-placeholder":"请输入角色名称"},on:{change:e.handleRoleChange},model:{value:e.roleIds,callback:function(t){e.roleIds=t},expression:"roleIds"}},[i("span",{attrs:{slot:"left-footer",size:"small"},slot:"left-footer"},[i("el-pagination",{attrs:{"current-page":e.numberPage,"pager-count":5,total:e.numberTotal,background:"",layout:"prev, pager, next"},on:{"current-change":e.handleRoleCurrentChange}})],1),e._v(" "),i("span",{attrs:{slot:"right-footer",size:"small"},slot:"right-footer"})])],1),e._v(" "),i("el-dialog",{attrs:{visible:e.fileGroupdialogVisible,title:"授权文件组",width:"800px"},on:{"update:visible":function(t){e.fileGroupdialogVisible=t}}},[i("el-transfer",{directives:[{name:"loading",rawName:"v-loading",value:e.fileGroupLoading,expression:"fileGroupLoading"}],staticClass:"box",attrs:{data:e.fileGroupData,titles:["其他文件组","权限拥有文件组"],filterable:"","filter-placeholder":"请输入文件组名称"},on:{change:e.handleFileGroupChange},model:{value:e.fileGroupIds,callback:function(t){e.fileGroupIds=t},expression:"fileGroupIds"}},[i("span",{attrs:{slot:"left-footer",size:"small"},slot:"left-footer"},[i("el-pagination",{attrs:{"current-page":e.numberPage,"pager-count":5,total:e.numberTotal,background:"",layout:"prev, pager, next"},on:{"current-change":e.handleFileGroupCurrentChange}})],1),e._v(" "),i("span",{attrs:{slot:"right-footer",size:"small"},slot:"right-footer"})])],1),e._v(" "),i("el-dialog",{attrs:{visible:e.menuDialogVisible,title:"授权菜单和功能",width:"500px"},on:{"update:visible":function(t){e.menuDialogVisible=t}}},[i("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.menuLoading,expression:"menuLoading"}],ref:"tree",attrs:{data:e.data2,"default-expanded-keys":e.data3,"default-checked-keys":e.data3,props:e.defaultProps,"node-key":"id","show-checkbox":""},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node;return t.data,i("span",{staticClass:"custom-tree-node"},[i("span",[i("i",{class:s.icon,staticStyle:{"margin-right":"3px"}}),e._v(e._s(s.label)+"\n        ")])])}}])}),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.getCheckedKeys}},[e._v("确 定")]),e._v(" "),i("el-button",{on:{click:function(t){e.menuDialogVisible=!1}}},[e._v("取 消")])],1)],1)],1)},[],!1,null,null,null);r.options.__file="permissionManagement.vue";t.default=r.exports},"SPw+":function(e,t,i){}}]);