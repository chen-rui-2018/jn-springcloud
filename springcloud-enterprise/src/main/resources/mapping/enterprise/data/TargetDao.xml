<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jn.enterprise.data.dao.TargetDao">
    <select id="getTargetFromTab" resultType="com.jn.enterprise.data.entity.TbDataReportingTarget" parameterType="java.lang.String">
        select <include refid="com.jn.enterprise.data.dao.TbDataReportingTargetMapper.Base_Column_List"/>
        from Tb_Data_Reporting_Target
        where target_id
        in (
          select target_id from tb_data_reporting_model_struct
          where tab_id =#{tabId}
        )

    </select>

    <insert id="createTab" parameterType="java.util.List">
        insert into Tb_Data_Reporting_Model_Tab t
        (<include refid="com.jn.enterprise.data.dao.TbDataReportingModelTabMapper.Base_Column_List"/>)
        values
        <foreach collection="tabVOList" index="index" item="item" open="(" separator="," close=")">
            (#{item.tabId,jdbcType=VARCHAR},
            #{item.id,jdbcType=VARCHAR},
            #{item.modelId,jdbcType=VARCHAR},
            #{item.tabName,jdbcType=VARCHAR},
            #{item.tabClumnTargetShow,jdbcType=CHAR},
            #{item.tabClumnType,jdbcType=TINYINT},
            #{item.status,jdbcType=TINYINT},
            #{item.tabCreateType,jdbcType=TINYINT},
            #{item.order,jdbcType=VARCHAR}
            )
        </foreach>
    </insert>


    <insert id="createRelation" parameterType="java.util.List">
        insert into Tb_Data_Reporting_Model_Struct t
        (<include refid="com.jn.enterprise.data.dao.TbDataReportingModelStructMapper.Base_Column_List"/>)
        values
        <foreach collection="relationModels" index="index" item="item" open="(" separator="," close=")">
            #{item.id,jdbcType=VARCHAR},
            #{item.targetId,jdbcType=VARCHAR},
            #{item.modelId,jdbcType=VARCHAR},
            #{item.tabId,jdbcType=VARCHAR}
        </foreach>
    </insert>

    <insert id="createInputFormater" parameterType="java.util.List">
        insert into Tb_Data_Reporting_Target_Group t
        (<include refid="com.jn.enterprise.data.dao.TbDataReportingTargetGroupMapper.Base_Column_List"/>)
        values
        <foreach collection="relationModels" index="index" item="item" open="(" separator="," close=")">
            #{item.formId,jdbcType=VARCHAR},
            #{item.id,jdbcType=VARCHAR},
            #{item.targetId,jdbcType=VARCHAR},
            #{item.formType,jdbcType=VARCHAR},
            #{item.formName,jdbcType=VARCHAR},
            #{item.require,jdbcType=TINYINT},
            #{item.order,jdbcType=INTEGER},
            #{item.choiceOption,jdbcType=VARCHAR},
            #{item.recordStatus,jdbcType=TINYINT}
        </foreach>
    </insert>

</mapper>