<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jn.park.asset.dao.RoomInformationDao">

    <update id="updateStatus" parameterType="java.util.Map">
        UPDATE tb_room_information
        SET state = #{roomStatus}
        WHERE
            id = #{roomId}
    </update>

    <select id="getRoomLeaseList" parameterType="java.lang.String" resultType="com.jn.park.asset.model.RoomInformationModel">
        SELECT
        tb.id,
        tb.NAME,
        tb.floor,
        tb.tower_id AS towerId,
        tb.tower_name AS towerName,
        tb.group_id AS groupId,
        tb.group_name AS groupName,
        tb.room_area AS roomArea,
        tb.shortest_lease AS shortestLease,
        tb.lease_price AS leasePrice,
        tb.lease_sum AS leaseSum,
        tb.press,
        tb.pay,
        tb.press_pay AS pressPay,
        tb.house_type AS houseType,
        tb.img_url AS imgUrl,
        tb.floor_plan AS floorPlan,
        tb.room_plan AS roomPlan,
        tb.introduce,
        tb.state,
        tb.lease_start_time AS leaseStartTime,
        tb.lease_end_time leaseEndTime,
        tb.enterprise_id AS enterpriseId,
        tb.lease_enterprise AS leaseEnterprise,
        tb.contact_name AS contactName,
        tb.contact_phone AS contactPhone,
        tb.create_Time AS createTime,
        tw.address AS address
        FROM
        tb_room_information tb LEFT JOIN tb_tower_information tw on tb.tower_id = tw.id
        WHERE tb.record_status = '1'
         <if test="_parameter != null and _parameter != ''">
             and  (tb.NAME LIKE CONCAT('%', #{name}, '%') or tb.tower_name Like CONCAT('%', #{name}, '%'))
         </if>
          and tb.state in ('0','4')
    </select>
</mapper>
